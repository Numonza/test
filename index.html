<html lang="en">

<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href='https://fonts.googleapis.com/css?family=Bai Jamjuree' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous" />
    <title></title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous"></script>

    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

    <!-- CSS bootstrap@5.1.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="mt-4 text-center">
        <div clas="justify-content-center align-items-center">
            <!-- -------- ตัวเลขนับถอยหลัง ------ -->
<!--             <div id="timer"></div> -->

            <!-- -------- ข้อความแจ้งเตือนด้านล่างของตัวนับ ------ -->
            <div class="mt-4 text-center text-light" id="msgStatus"></div>
        </div>
    </div>
<!--     <section id="cover" style="display:none;"> -->
    
        <div id="loginPage" style="display:block;">
            <div id="login-form" class="container-sm fade-in-page mt-4 card-form "
                style="max-width: 25rem; display:block;">
                <div class="container py-4">
                    <div class="form-group mt-3">
                        <form id="loginForm" class="was-validated" autocomplete="off" name="google-sheet"
                            onsubmit="return validateForm()">
                            <div class="container">
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-12 center">
                                    <div class="form-row">
                                        <div class="form-group col-md-12">
                                            <center> <img id="picURL" class="avatar" alt="Cinque Terre" width="90"
                                                    height="90"><br></center>
                                            <div class="mb-3 mt-3">
                                                <label for="uname" class="form-label">ชื่อแสดงใน Line:</label>
                                                <input type="text" class="form-control" name="UName" id="uname"
                                                    readonly>
                                                <input id="uid" class="form-control" name="Uid" style="display:none;">
                                                <img id="upic" name="Upic" width="25%">
                                            </div>
                                        </div>
<!--                                         <div class="form-group col-md-12">
                                            <label for="number1">เบอร์โทรติดต่อ</label>
                                            <input type="tel" class="form-control" pattern="[0-9]{10}"
                                                oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                placeholder="ระบุเบอร์โทรติดต่อกลับ" id="tel" name="tel" maxlength="10"
                                                minlength="10" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนเบอร์โทรให้ครบ10หลัก</div>
                                        </div> -->

                                        <div class="form-group col-md-12">
                                            <label for="number1">ชื่อ-สกุล</label>
                                            <input type="text" class="form-control" placeholder="กรุณากรอกช้อมูล" id="number1"
                                                name="number1" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div>
<!--                                         <div class="form-group col-md-12">
                                            <label for="number2">วันเกิด</label>
                                            <input type="date" class="form-control" placeholder="เลขที่2" id="number2"
                                                name="number2" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div> -->
<!--                                         <div class="form-group col-md-12">
                                            <label for="number3">email</label>
                                            <input type="email" class="form-control" placeholder="เลขที่3" id="number3"
                                                name="number3" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div> -->
                                        <div class="form-group col-md-12">
                                            <label for="number4">ตำแหน่ง</label>
                                            <input type="text" class="form-control" placeholder="กรุณากรอกช้อมูล" id="number4"
                                                name="number4" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div>
                                        <div class="form-group col-md-12">
                                            <label for="number5">โครงการ/โซน</label>
                                            <input type="text" class="form-control" placeholder="กรุณากรอกช้อมูล" id="number5"
                                                name="number5" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div>
                                        <div class="form-group col-md-12">
                                            <label for="number3">บริษัท</label>
                                            <input type="text" class="form-control" placeholder="กรุณากรอกช้อมูล" id="number3"
                                                name="number3" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div>
                                    </div>
                                    <div class="row"> </div>
                                    <div class="col"> </div>
                                    <div class="form-check mb-3">
                                        <script
                                            src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
                                        <input type="checkbox" class="form-check-input" name='visto' id='visto' value=''
                                            required>
                                        <label class="form-check-label"
                                            for="validationFormCheck1">ยืนยันข้อมูลตามด้านบน</label>
                                        <div class="invalid-feedback">หากไม่ยืนยันจะไม่สามารถลงทะเบียนได้
                                        </div>
                                    </div>
                                    <button type="submit" name="submit" id="submit"
                                        class="btn btn-primary bd-indigo-500 btn-block text-white" disabled><i
                                            class="fas fa-paper-plane"></i> ลงทะเบียน</button>
                                </div>
                            </div>
                    </div>
                </div>
            </div>

            </form>

        </div>
        </div>
        </div>







        <script type="text/javascript">
          

            window.onload = function () {
                initializeLiff("2001518093-lzNoRPjJ");
            };

            function initializeLiff(myLiffId) {
                liff
                    .init({
                        liffId: myLiffId
                    })
                    .then(() => {
                        getid();
                    })
                    .then(() => {
                        testclick();
                    })
                    .catch(err => { });
            }

            function getid() {
                liff.getProfile().then(function (profile) {
                    const uid = profile.userId;
                    const uname = profile.displayName;
                    const upic = profile.pictureUrl;
                    document.getElementById("picURL").src = upic;  // แสดงรูป Profile ที่ดึงมา
                    document.getElementsByName("Uid")[0].value = uid;
                    document.getElementsByName("UName")[0].value = uname;
                    document.getElementsByName("Upic")[0].value = upic;
                });
            }

            function testclick() {
                //button1
                document.getElementById("submit").addEventListener("click", function () {
                    liff.getProfile().then(profile => {
                        var name = profile.displayName;
                        var picURL = profile.pictureUrl;
                        var uid = profile.userId;
                        // var tel = document.getElementById("tel");
                        var number1 = document.getElementById("number1");
                        // var number2 = document.getElementById("number2");
                        var number3 = document.getElementById("number3");
                        var number4 = document.getElementById("number4");
                        var number5 = document.getElementById("number5");

                        liff
                            .sendMessages([
                                {
                                    type: "flex",
                                    altText: "ลงทะเบียนสำเร็จ",
                                    contents: {
                                         "type": "bubble",
                                              "body": {
                                                "type": "box",
                                                "layout": "vertical",
                                                "contents": [
                                                  {
                                                    "type": "box",
                                                    "layout": "horizontal",
                                                    "contents": [
                                                      {
                                                        "type": "box",
                                                        "layout": "vertical",
                                                        "contents": [
                                                          {
                                                            "type": "box",
                                                            "layout": "vertical",
                                                            "contents": [
                                                              {
                                                                "type": "image",
                                                                "url": "" + picURL,
                                                                "aspectMode": "cover",
                                                                "size": "full"
                                                              }
                                                            ],
                                                            "cornerRadius": "100px",
                                                            "width": "80px",
                                                            "height": "80px",
                                                            "offsetStart": "90px",
                                                            "margin": "md"
                                                          },
                                                          {
                                                            "type": "text",
                                                            "text": name,
                                                            "size": "xl",
                                                            "color": "#228B22",
                                                            "weight": "bold",
                                                            "align": "center",
                                                            "offsetTop": "md",
                                                            "margin": "md"
                                                          },
                                                          {
                                                            "type": "text",
                                                            "text": "🎉ลงทะเบียนสำเร็จแล้ว🎉",
                                                            "color": "#228B22",
                                                            "size": "lg",
                                                            "align": "center",
                                                            "margin": "md",
                                                            "weight": "bold"
                                                          },
                                                          {
                                                            "type": "box",
                                                            "layout": "vertical",
                                                            "contents": [
                                                              {
                                                                "type": "box",
                                                                "layout": "baseline",
                                                                "contents": [
                                                                  {
                                                                    "type": "icon",
                                                                    "url": "https://img2.pic.in.th/pic/id-card-1.png",
                                                                    "offsetStart": "sm"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "ชื่อ -สกุล:",
                                                                    "weight": "bold",
                                                                    "margin": "md",
                                                                    "color": "#000000",
                                                                    "align": "start"
                                                                  }
                                                                ],
                                                                "margin": "md"
                                                              },
                                                              {
                                                                "type": "box",
                                                                "layout": "baseline",
                                                                "contents": [
                                                                  {
                                                                    "type": "icon",
                                                                    "url": "https://img5.pic.in.th/file/secure-sv1/pointing-right.png",
                                                                    "offsetStart": "sm"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "" + number1.value,
                                                                    "size": "md",
                                                                    "weight": "bold",
                                                                    "color": "#990000",
                                                                    "align": "center",
                                                                    "wrap": true,
                                                                    "scaling": true,
                                                                    "offsetStart": "sm"
                                                                  }
                                                                ]
                                                              },
                                                              {
                                                                "type": "box",
                                                                "layout": "baseline",
                                                                "contents": [
                                                                  {
                                                                    "type": "icon",
                                                                    "url": "https://img2.pic.in.th/pic/career-promotion.png",
                                                                    "offsetStart": "sm"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "ตำแหน่ง:",
                                                                    "weight": "bold",
                                                                    "margin": "md",
                                                                    "color": "#000000"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "" + number4.value,
                                                                    "size": "md",
                                                                    "align": "start",
                                                                    "weight": "bold",
                                                                    "color": "#990000",
                                                                    "wrap": true,
                                                                    "scaling": true
                                                                  }
                                                                ],
                                                                "margin": "md"
                                                              },
                                                              {
                                                                "type": "box",
                                                                "layout": "baseline",
                                                                "contents": [
                                                                  {
                                                                    "type": "icon",
                                                                    "url": "https://img2.pic.in.th/pic/locationba8eaa2f694e3d03.png",
                                                                    "offsetStart": "sm"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "โครงการ/โซน:",
                                                                    "weight": "bold",
                                                                    "margin": "md",
                                                                    "color": "#000000"
                                                                  },
                                                                  {
                                                                    "type": "text",
                                                                    "text": "" + number5.value,
                                                                    "size": "md",
                                                                    "align": "start",
                                                                    "weight": "bold",
                                                                    "color": "#990000",
                                                                    "wrap": true,
                                                                    "scaling": true
                                                                  }
                                                                ],
                                                                "margin": "md"
                                                              }
                                                            ],
                                                            "spacing": "sm",
                                                            "margin": "lg",
                                                            "height": "150px"
                                                          }
                                                        ],
                                                          "backgroundColor": "#40E0D0",
                                                            "cornerRadius": "md",
                                                            "height": "320px",
                                                            "borderColor": "#99FF33",
                                                            "borderWidth": "semi-bold"
                                                      }
                                                    ],
                                                    "paddingAll": "20px"
                                                  },
                                                  {
                                                    "type": "box",
                                                    "layout": "horizontal",
                                                    "contents": [
                                                      {
                                                        "type": "text",
                                                        "text": "🆔 :"+uid,
                                                        "wrap": true,
                                                        "weight": "bold",
                                                        "align": "start",
                                                        "size": "12px",
                                                        "margin": "xs",
                                                        "color": "#990000"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "box",
                                                    "layout": "vertical",
                                                    "contents": [
                                                      {
                                                        "type": "text",
                                                        "text": "⭐️⭐️⭐️⭐️❤️❤️❤️⭐️⭐️⭐️⭐️",
                                                        "align": "center",
                                                        "color": "#ff3333"
                                                      }
                                                    ],
                                                    "offsetTop": "xl"
                                                  }
                                                ],
                                                "paddingAll": "0px",
                                                "height": "430px",
                                                "backgroundColor": "#00CED1",
                                                "borderColor": "#FFFF00",
                                                "borderWidth": "bold",
                                                "cornerRadius": "md"
                                              }
        
                                    }

                                }
                            ])
                            //   Swal.fire({
                            //   icon: 'success',
                            //   title: 'ขอให้โชคดี !!',
                            //   showConfirmButton: false,
                            //   text: 'ท่านได้ส่งข้อมูลการทายเลขเรียบร้อยแล้วค่ะ',
                            //   timer: 1500
                            //   })
                            .then(function () {
                                liff.closeWindow();
                            });
                    });
                });
            }

       
            const scriptURL = 'https://script.google.com/macros/s/AKfycbwOJo_nKCg2OBpGrXu0tHm05KNIf_YYgQ50iBBxHUnWZZIop_Jt1WqP-9oG3J1yMaw5Ow/exec'
            const form = document.forms['google-sheet']

            form.addEventListener('submit', e => {
                e.preventDefault()
                fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                    .then(response => alert("You have successfully submitted."))
                    .catch(error => console.error('Error!', error.message))
            })
        </script>

        <script>
            $(document).ready(function () {
                $('#submit').prop('disabled', true);
                $('#visto').click(function () {
                    if ($(this).is(':checked')) {
                        $('#submit').prop('disabled', false);
                    }
                    else {
                        $('#submit').prop('disabled', true);
                    }
                });
            });
        </script>
        <script>
            function closeMe() {
                setTimeout(window.close, 0);
                liff.closeWindow();
            }




            function validateForm() {
                  var telField = document.getElementById("tel");
                  var number1Field = document.getElementById("number1");
                  var number2Field = document.getElementById("number2");
                  var number3Field = document.getElementById("number3");
                  var number4Field = document.getElementById("number4");
                  var number5Field = document.getElementById("number5");
                  var vistoCheckbox = document.getElementById("visto");
                  // Add your validation logic here
                  var isValid = true;

                  if (telField.value.length !== 10 || isNaN(telField.value)) {
                      isValid = false;
                    $('#submit').prop('disabled', true);
                  }

                  // Add more validation checks for other fields...

                  // Enable or disable the submit button based on validation result
                  var submitButton = document.getElementById("submit");
                  submitButton.disabled = !isValid;
                  return isValid;
                 $('#submit').prop('disabled', true);
              }
            }

            $(document).ready(function () {
                $('#submit').prop('disabled', true);

                $('#visto').click(function () {
                    if ($(this).is(':checked')) {
                        $('#submit').prop('disabled', false);
                    } else {
                        $('#submit').prop('disabled', true);
                    }
                });
            });
        </script>

        <script src="script.js" theme="blue" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
        integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
        crossorigin="anonymous"></script>
</body>

</html>
